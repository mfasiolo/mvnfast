<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mean-shift mode seeking algorithm — ms • mvnfast</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">mvnfast</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/mvnfast.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mfasiolo/mvnfast">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mean-shift mode seeking algorithm</h1>
    </div>

    
    <p>Given a sample from a d-dimensional distribution, an initialization point and a bandwidth
             the algorithm finds the nearest mode of the corresponding Gaussian kernel density.</p>
    

    <pre class="usage"><span class='fu'>ms</span>(<span class='no'>X</span>, <span class='no'>init</span>, <span class='no'>H</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-06</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>store</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>n by d matrix containing the data.</p></td>
    </tr>
    <tr>
      <th>init</th>
      <td><p>d-dimensional vector containing the initial point for the optimization.</p></td>
    </tr>
    <tr>
      <th>H</th>
      <td><p>Positive definite bandwidth matrix representing the covariance of each component of the Gaussian kernel density.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Tolerance used to assess the convergence of the algorithm, which is stopped if the absolute values
of increments along all the dimensions are smaller then tol at any iteration. Default value is 1e-6.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>Number of cores used. The parallelization will take place only if OpenMP is supported.</p></td>
    </tr>
    <tr>
      <th>store</th>
      <td><p>If <code>FALSE</code> only the latest iteration is returned, if <code>TRUE</code> the function will return a matrix where
the i-th row is the position of the algorithms at the i-th iteration.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list where <code>estim</code> is a d-dimensional vector containing the last position of the algorithm, while <code>traj</code> 
        is a matrix with d-colums representing the trajectory of the algorithm along each dimension. If <code>store == FALSE</code> the whole trajectory
        is not stored and <code>traj = NULL</code>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'>set.seed</span>(<span class='fl'>434</span>)

<span class='co'># Simulating multivariate normal data</span>
<span class='no'>N</span> <span class='kw'>&lt;-</span> <span class='fl'>1000</span>
<span class='no'>mu</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>2</span>)
<span class='no'>sigma</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>0.5</span>, <span class='fl'>0.5</span>, <span class='fl'>1</span>), <span class='fl'>2</span>, <span class='fl'>2</span>)
<span class='no'>X</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rmvn.html'>rmvn</a></span>(<span class='no'>N</span>, <span class='kw'>mu</span> <span class='kw'>=</span> <span class='no'>mu</span>, <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='no'>sigma</span>)

<span class='co'># Plotting the true density function</span>
<span class='no'>steps</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
<span class='no'>range1</span> <span class='kw'>&lt;-</span> <span class='fu'>seq</span>(<span class='fu'>min</span>(<span class='no'>X</span>[ , <span class='fl'>1</span>]), <span class='fu'>max</span>(<span class='no'>X</span>[ , <span class='fl'>1</span>]), <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='no'>steps</span>)
<span class='no'>range2</span> <span class='kw'>&lt;-</span> <span class='fu'>seq</span>(<span class='fu'>min</span>(<span class='no'>X</span>[ , <span class='fl'>2</span>]), <span class='fu'>max</span>(<span class='no'>X</span>[ , <span class='fl'>2</span>]), <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='no'>steps</span>)
<span class='no'>grid</span> <span class='kw'>&lt;-</span> <span class='fu'>expand.grid</span>(<span class='no'>range1</span>, <span class='no'>range2</span>)
<span class='no'>vals</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='dmvn.html'>dmvn</a></span>(<span class='fu'>as.matrix</span>(<span class='no'>grid</span>), <span class='no'>mu</span>, <span class='no'>sigma</span>)

<span class='fu'>contour</span>(<span class='kw'>z</span> <span class='kw'>=</span> <span class='fu'>matrix</span>(<span class='no'>vals</span>, <span class='no'>steps</span>, <span class='no'>steps</span>),  <span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>range1</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>range2</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"X1"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>"X2"</span>)
<span class='fu'>points</span>(<span class='no'>X</span>[ , <span class='fl'>1</span>], <span class='no'>X</span>[ , <span class='fl'>2</span>], <span class='kw'>pch</span> <span class='kw'>=</span> <span class='st'>'.'</span>)

<span class='co'># Estimating the mode from "nrep" starting points</span>
<span class='no'>nrep</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>
<span class='no'>index</span> <span class='kw'>&lt;-</span> <span class='fu'>sample</span>(<span class='fl'>1</span>:<span class='no'>N</span>, <span class='no'>nrep</span>)
<span class='kw'>for</span>(<span class='no'>ii</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='no'>nrep</span>) {
  <span class='no'>start</span> <span class='kw'>&lt;-</span> <span class='no'>X</span>[<span class='no'>index</span>[<span class='no'>ii</span>], ]
  <span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>ms</span>(<span class='no'>X</span>, <span class='kw'>init</span> <span class='kw'>=</span> <span class='no'>start</span>, <span class='kw'>H</span> <span class='kw'>=</span> <span class='fl'>0.1</span> * <span class='no'>sigma</span>, <span class='kw'>store</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
  <span class='fu'>lines</span>(<span class='no'>out</span>$<span class='no'>traj</span>[ , <span class='fl'>1</span>], <span class='no'>out</span>$<span class='no'>traj</span>[ , <span class='fl'>2</span>], <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>2</span>)
  <span class='fu'>points</span>(<span class='no'>out</span>$<span class='no'>final</span>[<span class='fl'>1</span>], <span class='no'>out</span>$<span class='no'>final</span>[<span class='fl'>2</span>], <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>4</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>3</span>) <span class='co'># Estimated mode (blue)</span>
  <span class='fu'>points</span>(<span class='no'>start</span>[<span class='fl'>1</span>], <span class='no'>start</span>[<span class='fl'>2</span>], <span class='kw'>col</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>lwd</span> <span class='kw'>=</span> <span class='fl'>3</span>)         <span class='co'># ii-th starting value </span>
}
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Matteo Fasiolo &lt;matteo.fasiolo@gmail.com&gt;.

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matteo Fasiolo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
